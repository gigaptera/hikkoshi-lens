# 画面設計書 (Hikkoshi Lens)

## 1. デザインコンセプト: "Modern Museum"

- **哲学**: データを芸術として扱う。ミニマリスト、高コントラスト、鋭利なエッジ。
- **ビジュアルトークン**:
  - **形状**: `rounded-none` (完全な角丸なし、0px)。
  - **タイポグラフィ**:
    - **Display**: `Playfair Display` (Serif)。感情的な訴求（見出し、スコア表示）。
    - **Data**: `JetBrains Mono` (Monospace)。精密さの表現（家賃、距離、ラベル）。
    - **Body**: `Inter` (Sans)。UI の可読性。
  - **配色**:
    - **Light**: 背景 `#FAFAFA`, 文字 `#1A1A1A`。
    - **Dark**: 背景 `#171717`, 文字 `#FAFAFA`。
    - **Primary**: モノクローム（`#000` または `#FFF`）。アクセントは最小限に。

---

## 2. 画面仕様

### 2.1 ランディングページ (`/`)

**目的**: ユーザーを没入させ、主要な検索意図（場所 + 重視する条件）を即座にキャプチャする。

#### レイアウト構造

- **ヘッダー**: ミニマルなブランドロゴ (Serif)、「ログイン」ボタン (Outline)。
- **ヒーローセクション**:
  - 中央揃えの巨大なタイポグラフィ: _"Find Your Perfect Place"_ (Serif, `9vw`)。
  - サブテキスト: _"Data-driven relocation intelligence."_ (Sans)。
- **検索ウィジェット** (フローティングカード):
  - **入力グループ**:
    - アイコン: `MapPin` (Thin)。
    - フィールド: "Station, Area, or Work Address" (鋭利な Input)。
  - **条件チューナー** (展開パネル):
    - トリガー: "Preferences" ボタン (アイコン + テキスト)。
    - コンテンツ: 5 つのスライダー（家賃、アクセス、治安、周辺施設、防災）。
    - スタイル: 極細トラック (`h-px`)、正方形サム (`h-4 w-4`)。
  - **アクション**: "Search" ボタン (Solid, Serif, uppercase)。

#### ロジック & データ

- **State**:
  - `location`: string (ユーザー入力)。
  - `weights`: Object `{ rent: 50, access: 50, ... }`。
- **ナビゲーション**:
  - 送信時 -> `/search/result?q={location}&w_rent={...}&...`

---

### 2.2 検索結果ページ (`/search/result`)

**目的**: 評価された駅を、厳選されたコレクションとして提示する。

#### レイアウト構造

- **ヘッダー**: "Back to Search" リンク、結果件数 (Mono)。
- **メイングリッド**: レスポンシブグリッド (`grid-cols-1` ～ `grid-cols-4`)。
- **コントロールバー** (Sticky - 今後実装):
  - **フィルタートリガー**: "Rent Range", "Commute Time", "Subsidy"。
  - **ソート**: "Match Score" (デフォルト), "Rent: Low to High"。

#### コンポーネント: 駅カード (`StationCard`)

- **ビジュアル**: 縦長カード、角丸なし、ホバー時に「浮遊」するシャドウ。
- **画像エリア**:
  - 抽象的なマップまたはグラデーションプレースホルダー。
  - **マッチ度スコア**: 巨大な Serif オーバーレイ (例: "92")。
  - **バッジ**: 路線名 (Mono, 鋭利なバッジ)。
- **コンテンツエリア**:
  - **タイトル**: 駅名 (Serif)。
  - **メタ情報**: 職場からの距離 (Mono)。
  - **メトリックスグリッド**:
    - 平均家賃 (Mono)。
    - 治安スコア (Mono)。
- **補助金/隣接駅インジケーター**:
  - `is_nearby=true` の場合、"Subsidy Target via {SourceStation}" バッジを表示。

#### バックエンド連携

- **エンドポイント**: `GET /api/stations/search`
- **パラメータ**:
  - `lat`, `lon` (`q` からジオコーディング、またはモック)。
  - `w_{category}`: 重み付けスコアリング用 (**※現在バックエンド側でロジック未実装**)
  - `subsidy_type`: `from_workplace` (有効時)。

---

### 2.3 駅詳細ページ (`/stations/[id]`)

**目的**: 駅周辺の生活環境を深く分析し、ユーザーの「住むイメージ」を具体化する。物件探しへのスムーズな導線を提供する。

#### レイアウト構造

- **ヘッダー**: 共通ヘッダー（戻るリンク付き）。
- **メインコンテンツ（スプリットビューまたはグリッド）**:
  - **マップエリア (左/上)**:
    - 画面の大部分（または 50%）を占めるインタラクティブマップ。
    - **オーバーレイ機能**: 「治安ヒートマップ」「スーパーマーケット」「コンビニ」「公園」などのレイヤー切り替えトグル（地図上にフロート表示）。
  - **情報パネル (右/下)**:
    - **総合スコア**: 巨大な Serif で表示（例: "Total Score 92"）。カテゴリー別スコアの詳細チャート（レーダーチャート等）。
    - **周辺施設リスト**: 「食料品」「医療」「公共施設」などでグループ化されたリスト。
    - **アクション**: "Suumo で物件を見る", "Homes で物件を見る" などの外部リンクボタン（目立つ Outline スタイル）。

#### コンポーネント: 詳細機能

- **MapContainer**:
  - 技術スタック: **Mapbox GL JS** (`react-map-gl`).
  - スタイル: ダークモードまたは彩度を落とした「Museum」スタイル (Mapbox Studio でカスタマイズ)。
  - ピン: 施設カテゴリーごとに異なる鋭利なアイコン。
- **OverlaySwitcher**:
  - 地図上に浮かぶ半透明のコントロールパネル。`rounded-none`。
- **FacilityList**:
  - アコーディオンまたはスクロール可能なリスト。各アイテムは `Border-bottom` のみのミニマルなデザイン。

#### バックエンド連携

- **エンドポイント**: `GET /api/stations/{id}`
- **データ**:
  - 駅基本情報。
  - スコア詳細（カテゴリー別）。
  - 周辺施設リスト（座標付き）。
  - 混雑率データ（あれば）。

---

### 2.4 地点詳細ページ (`/location`)

**目的**: SUUMO 等で見つけた物件の住所を入力し、その地点周辺の詳細情報を確認・比較する。複数の候補物件を客観的データで比較検討できる。

#### ユーザージャーニー

```
1. Hikkoshi Lens で条件に合う駅を発見
2. SUUMO で気になる物件を複数発見
3. Hikkoshi Lens で各物件の住所を入力
   → 周辺スコアを確認・比較
   → 最終的な物件を決定
```

#### レイアウト構造

**2 カラム構造:**

- **左側: 地図エリア (50%)**:
  - インタラクティブマップ（Mapbox GL JS）。
  - 指定地点のマーカー表示。
  - 最寄り駅、周辺施設（コンビニ、スーパー、病院、公園）のマーカー。
  - **レイヤー切替トグル**: 表示する施設カテゴリーを選択可能。
- **右側: 情報パネル (50%)**:
  - **住所表示**: 入力された住所または緯度経度。
  - **アクセス評価カード**:
    - 最寄り駅名、路線、徒歩時間（分）、距離（m）。
    - スコア: 0-100。
  - **周辺施設カード**:
    - カテゴリー別の施設数（コンビニ、スーパー、病院、公園）。
    - 各施設の距離範囲。
    - スコア: 0-100。
  - **治安カード**:
    - 犯罪率レベル（低/中/高）。
    - スコア: 0-100。
  - **物価カード**:
    - 周辺家賃相場（1K/1LDK/2LDK 等）。
    - 物価レベル（低/中/高）。
    - スコア: 0-100。
  - **総合スコア**: 巨大な Serif フォントで表示（例: "81/100"）。
  - **アクションボタン**: "検討リストに追加"（将来機能）。

#### コンポーネント詳細

- **LocationMap**:
  - `react-map-gl` を使用。
  - 「Museum」スタイル（彩度を落とした配色）。
  - カスタムマーカー: 施設カテゴリーごとに異なるアイコン。
- **ScoreCard**:

  - 鋭利な `border` (`rounded-none`)。
  - Mono フォントでデータ表示。
  - ホバー時に `shadow-lg`。

- **LayerToggle**:
  - 地図上にフロート表示する半透明パネル。
  - チェックボックスで施設レイヤーを切替。

#### バックエンド連携

- **エンドポイント**: `GET /api/location/detail` **※新規実装予定**
- **パラメータ**:
  - `address`: 住所文字列 (optional)
  - `lat`, `lng`: 緯度経度 (optional)
- **レスポンス**:
  - 最寄り駅情報
  - 周辺施設リスト（座標付き）
  - 各種スコア（Access, Facility, Safety, Cost, Total）
  - 家賃相場データ

#### ヘッダー検索バーの機能化

**目的**: グローバルヘッダーの検索バーから直接地点詳細ページにアクセス可能にする。

**実装**:

- 住所/駅名を入力 → Geocoding API で緯度経度を取得。
- `/location?lat={lat}&lng={lng}` に遷移。
- サジェスト機能（Google Places Autocomplete 等）の追加を検討。

---

## 3. インタラクション詳細

- **ホバー効果**:
  - カードがわずかに浮上 (`translate-y-[-2px]`) し、影が濃くなる。
  - ボタンは反転色になるか、細いアンダーラインアニメーションを表示。
- **トランジション**:
  - ページ遷移: View Transitions API (対応時) またはシンプルなフェードイン。
  - チューナー: アコーディオンのスライド展開。

## 4. 今後の実装タスク

1. **ランディングページの洗練**: スライダーの挙動を「Museum」の雰囲気（キビキビとした精密な動き）に合わせる。
2. **検索結果ページの洗練**:
   - コントロールバーの実装（リアルタイムフィルター）。
   - API から返される `score_details` をカードのメトリクスに接続。
   - 空の状態やローディング状態に「Museum」スタイルのスケルトンを適用。
